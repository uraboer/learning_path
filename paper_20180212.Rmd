---
title: "对高并发流量控制的一点思考"
author: "uraboer"
date: "2018年2月12日"
output: html_document
---

### 应对大流量的一些思路

大流量：TPS(每秒事务量),QPS(每秒请求量),如果这个量造成了系统的压力，影响了系统的性能

应对大流量的一些常见手段：
- 缓存：让数据尽早进入缓存，离程序近一点，不要大量频繁访问DB
- 降级：如果不是核心链路，就把这个服务降级掉
- 限流：在一定时间内把请求限制在一定范围内，保证系统不被冲垮，同时尽可能提升系统的吞吐量

### 限流的常用方式
- 计数器：在接口层面，在一段时间内，进行计数，与阀值进行比较，到了时间临界点，将计数器清0

(这里需要注意的是，存在一个时间临界点的问题。举个栗子，在12:01:00到12:01:58这段时间内没有用户请求，然后在12:01:59这一瞬时发出100个请求，OK，然后在12:02:00这一瞬时又发出了100个请求。这里你应该能感受到，在这个临界点可能会承受恶意用户的大量请求，甚至超出系统预期的承受。)

- 滑动窗口：把固定时间片进行划分，并且随着时间的流逝，进行移动，这样就巧妙地避开了计数器的临界点问题。也就是说这些固定数量的可以移动的格子，将会进行计数判断阀值，因此格子的数量影响着滑动窗口算法的精度。


- 漏桶：虽然滑动窗口有效避免了时间临界点的问题，但是依然有时间片的概念，而漏桶算法在这方面比滑动窗口而言，更加先进

有一个固定的桶，进水的速率是不确定的，但是出水的速率是恒定的，当水满的时候是会溢出的。













